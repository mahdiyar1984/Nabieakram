{% extends 'shared/_layout.html' %}
{% load static %}
{% load shamsi_tags %}
{% load render_partial %}
{% load dict_filters %}
{% load humanize %}

{% block title %}
    ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å
{% endblock %}
{% block content %}

    <!-- breadcrumb -->
    <section class="breadcrumb-area section-padding img-bg-3">
        <div class="overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb-content d-flex flex-wrap align-items-center justify-content-between">
                        <ul class="generic-list-item generic-list-item-white generic-list-item-arrow d-flex flex-wrap align-items-center">
                            <li><a href="{% url 'main_app:index' %}">ÿµŸÅÿ≠Ÿá ÿßÿµŸÑ€å</a></li>
                            <li><a href="{% url 'media_app:lecture_list_page' %}">ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å Ÿáÿß</a></li>
                            <li>{{ lecture.title }}</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="course-area section--padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">

                    <!-- video & sound & text -->
                    <div class="card card-item">
                        <div class="card-body">
                            <div class="course-details-content-wrap">
                                <!-- title -->
                                <h4>{{ lecture.title }}</h4><br>

                                <!-- video -->
                                {% if lecture.video %}
                                    <p>ŸÅ€åŸÑŸÖ ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å - <a href="{{ lecture.video.url }}" download>ÿØÿßŸÜŸÑŸàÿØ</a></p>
                                    <style>
                                        .custom-player-container {
                                            position: relative;
                                            width: 100%;
                                            max-width: 700px;
                                            margin: 0 auto;
                                            background: #181c24;
                                            border-radius: 0;
                                            overflow: hidden;
                                            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.18);
                                        }

                                        .custom-video {
                                            width: 100%;
                                            display: block;
                                            background: #000;
                                        }

                                        .custom-controls {
                                            position: absolute;
                                            bottom: 0;
                                            left: 0;
                                            right: 0;
                                            background: linear-gradient(0deg, rgba(24, 28, 36, 0.95) 80%, rgba(24, 28, 36, 0.2) 100%);
                                            display: flex;
                                            flex-direction: row;
                                            align-items: center;
                                            justify-content: flex-start;
                                            padding: 12px 18px 8px 18px;
                                            gap: 10px;
                                            z-index: 2;
                                            transition: opacity 0.3s;
                                        }

                                        .custom-btn {
                                            background: #232a36;
                                            color: #fff;
                                            border: none;
                                            border-radius: 0;
                                            padding: 7px 14px;
                                            font-size: 1.1em;
                                            cursor: pointer;
                                            transition: background 0.2s;
                                            outline: none;
                                        }

                                        .custom-btn:hover {
                                            background: #2d3646;
                                        }

                                        .custom-slider {
                                            flex: 1;
                                            margin: 0 12px;
                                            accent-color: #4fc3f7;
                                            height: 4px;
                                        }

                                        .custom-time {
                                            color: #b0b8c1;
                                            font-size: 0.95em;
                                            min-width: 70px;
                                            text-align: center;
                                            font-family: monospace;
                                        }
                                    </style>

                                    <div class="custom-player-container">
                                        <video id="myCustomVideo" class="custom-video" preload="metadata">
                                            <source src="{{ lecture.video.url }}" type="video/mp4">
                                            ŸÖÿ±Ÿàÿ±⁄Øÿ± ÿ¥ŸÖÿß ÿßÿ≤ Ÿà€åÿØ€åŸà Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ€å ŸÜŸÖ€å‚Äå⁄©ŸÜÿØ.
                                        </video>
                                        <div class="custom-controls" id="myCustomControls">
                                            <button class="custom-btn" id="playPauseBtn">‚ñ∂Ô∏è</button>
                                            <span class="custom-time" id="currentTime">00:00</span>
                                            <input type="range" class="custom-slider" id="seekBar" value="0" min="0" max="0" step="0.1">
                                            <span class="custom-time" id="duration">00:00</span>
                                            <button class="custom-btn" id="muteBtn">üîä</button>
                                            <input type="range" class="custom-slider" id="volumeBar" value="100" min="0" max="100" style="max-width:80px;">
                                            <button class="custom-btn" id="fullscreenBtn">‚õ∂</button>
                                        </div>
                                    </div>
                                    <script>
                                        const video = document.getElementById('myCustomVideo');
                                        const playPauseBtn = document.getElementById('playPauseBtn');
                                        const seekBar = document.getElementById('seekBar');
                                        const currentTimeEl = document.getElementById('currentTime');
                                        const durationEl = document.getElementById('duration');
                                        const muteBtn = document.getElementById('muteBtn');
                                        const volumeBar = document.getElementById('volumeBar');
                                        const fullscreenBtn = document.getElementById('fullscreenBtn');
                                        const controls = document.getElementById('myCustomControls');
                                        let hideControlsTimeout;
                                        let isSeeking = false;
                                        let isMetadataLoaded = false;   // ‚úÖ Ÿæÿ±⁄ÜŸÖ ÿ®ÿ±ÿß€å ŸÑŸàÿØ ÿ¥ÿØŸÜ Ÿà€åÿØ€åŸà

                                        function formatTime(sec) {
                                            sec = Math.floor(sec);
                                            const m = Math.floor(sec / 60);
                                            const s = sec % 60;
                                            return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
                                        }

                                        // ŸàŸÇÿ™€å Ÿà€åÿØ€åŸà ÿ¢ŸÖÿßÿØŸá ÿ¥ÿØ
                                        video.addEventListener('loadedmetadata', () => {
                                            isMetadataLoaded = true; // ‚úÖ
                                            seekBar.max = Math.floor(video.duration);
                                            seekBar.value = 0;
                                            durationEl.textContent = formatTime(video.duration);
                                            currentTimeEl.textContent = formatTime(0);
                                            seekBar.disabled = video.duration === 0;
                                        });

                                        // ÿ®ÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ≤ŸÖÿßŸÜ
                                        video.addEventListener('timeupdate', () => {
                                            if (!isSeeking && isMetadataLoaded) {
                                                seekBar.value = video.currentTime;
                                                currentTimeEl.textContent = formatTime(video.currentTime);
                                            }
                                        });

                                        // ŸÜŸÖÿß€åÿ¥ ÿ≤ŸÖÿßŸÜ ÿØÿ± ŸáŸÜ⁄ØÿßŸÖ ⁄©ÿ¥€åÿØŸÜ
                                        seekBar.addEventListener('input', (e) => {
                                            if (!isMetadataLoaded) return; // ‚úÖ ÿß⁄ØŸá ÿ¢ŸÖÿßÿØŸá ŸÜ€åÿ≥ÿ™ÿå ⁄©ÿßÿ±€å ŸÜ⁄©ŸÜ
                                            currentTimeEl.textContent = formatTime(e.target.value);
                                        });

                                        // ÿ¥ÿ±Ÿàÿπ Drag
                                        seekBar.addEventListener('mousedown', () => isSeeking = true);
                                        seekBar.addEventListener('touchstart', () => isSeeking = true);

                                        // Ÿæÿß€åÿßŸÜ Drag
                                        seekBar.addEventListener('mouseup', () => {
                                            if (!isMetadataLoaded) return; // ‚úÖ
                                            isSeeking = false;
                                            video.currentTime = Number(seekBar.value);
                                        });
                                        seekBar.addEventListener('touchend', () => {
                                            if (!isMetadataLoaded) return; // ‚úÖ
                                            isSeeking = false;
                                            video.currentTime = Number(seekBar.value);
                                        });

                                        // ⁄©ŸÜÿ™ÿ±ŸÑ ŸæÿÆÿ¥
                                        playPauseBtn.addEventListener('click', () => {
                                            if (video.paused) {
                                                video.play();
                                            } else {
                                                video.pause();
                                            }
                                        });

                                        video.addEventListener('play', () => {
                                            playPauseBtn.textContent = '‚è∏Ô∏è';
                                        });
                                        video.addEventListener('pause', () => {
                                            playPauseBtn.textContent = '‚ñ∂Ô∏è';
                                        });

                                        // ⁄©ŸÜÿ™ÿ±ŸÑ ÿµÿØÿß
                                        muteBtn.addEventListener('click', () => {
                                            video.muted = !video.muted;
                                            muteBtn.textContent = video.muted ? 'üîá' : 'üîä';
                                        });

                                        volumeBar.addEventListener('input', () => {
                                            if (!isMetadataLoaded) return; // ‚úÖ
                                            video.volume = volumeBar.value / 100;
                                            video.muted = video.volume === 0;
                                            muteBtn.textContent = video.muted ? 'üîá' : 'üîä';
                                        });

                                        video.addEventListener('volumechange', () => {
                                            volumeBar.value = video.muted ? 0 : video.volume * 100;
                                            muteBtn.textContent = video.muted ? 'üîá' : 'üîä';
                                        });

                                        // ÿ™ŸÖÿßŸÖ‚ÄåÿµŸÅÿ≠Ÿá
                                        fullscreenBtn.addEventListener('click', () => {
                                            if (document.fullscreenElement) {
                                                document.exitFullscreen();
                                            } else {
                                                video.parentElement.requestFullscreen();
                                            }
                                        });

                                        // ŸÜŸÖÿß€åÿ¥/ŸÖÿÆŸÅ€å ⁄©ÿ±ÿØŸÜ ⁄©ŸÜÿ™ÿ±ŸÑ‚ÄåŸáÿß
                                        function showControls() {
                                            controls.style.opacity = '1';
                                            clearTimeout(hideControlsTimeout);
                                            hideControlsTimeout = setTimeout(() => {
                                                if (!video.paused) controls.style.opacity = '0';
                                            }, 2500);
                                        }

                                        video.parentElement.addEventListener('mousemove', showControls);
                                        video.addEventListener('play', showControls);
                                        video.addEventListener('pause', () => controls.style.opacity = '1');
                                        controls.addEventListener('mouseenter', () => clearTimeout(hideControlsTimeout));
                                        controls.addEventListener('mouseleave', showControls);
                                        controls.style.opacity = '1';

                                        // ÿß⁄Øÿ± Ÿà€åÿØ€åŸà duration ÿµŸÅÿ± ÿ®ŸàÿØ
                                        video.addEventListener('durationchange', () => {
                                            if (video.duration > 0) {
                                                seekBar.disabled = false;
                                                seekBar.max = Math.floor(video.duration);
                                            } else {
                                                seekBar.disabled = true;
                                                seekBar.value = 0;
                                            }
                                        });
                                    </script>
                                {% else %}
                                    <p>Ÿá€å⁄Ü ŸÅ€åŸÑŸÖ€å ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÜÿ¥ÿØŸá ÿßÿ≥ÿ™.</p>
                                {% endif %}

                                <!-- music -->
                                <p class="mt-3">
                                    ÿµŸàÿ™ ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å -
                                    <a href="{{ lecture.audio.url }}" download>ÿØÿßŸÜŸÑŸàÿØ</a>
                                </p>
                                <div style="width: 100%; border-radius: 0; overflow: hidden;">
                                    <audio controls class="w-100">
                                        <source src="{{ lecture.audio.url }}" type="audio/mp3">
                                    </audio>
                                </div>


                                <!-- text -->
                                <div class="pt-5">
                                    <h3 class="fs-24 font-weight-semi-bold pb-3">ÿÆŸÑÿßÿµŸá ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å</h3>
                                    <p class="fs-15 pb-2 text-justify">{{ lecture.text }}</p>
                                </div>

                                <div class="section-block mt-3"></div>
                                <h3 class="fs-18 font-weight-semi-bold pt-3 pb-3">ÿ®Ÿá ÿß€åŸÜ ŸÖÿ∑ŸÑÿ® ÿßŸÖÿ™€åÿßÿ≤ ÿ®ÿØŸá€åÿØ</h3>
                                {% if request.user.is_authenticated %}
                                    <div class="leave-rating-wrap pb-4">
                                        <div class="leave-rating leave--rating" id="rating2" data-lecture-id="{{ lecture.id }}" data-csrf="{{ csrf_token }}">
                                            <input type="radio" name="rate" id="star5" value="5">
                                            <label for="star5"></label>
                                            <input type="radio" name="rate" id="star4" value="4">
                                            <label for="star4"></label>
                                            <input type="radio" name="rate" id="star3" value="3">
                                            <label for="star3"></label>
                                            <input type="radio" name="rate" id="star2" value="2">
                                            <label for="star2"></label>
                                            <input type="radio" name="rate" id="star1" value="1">
                                            <label for="star1"></label>
                                        </div>
                                        <p id="rating-message" class="text-success" style="display:none;"></p>
                                    </div>
                                {% else %}
                                    <a href="{% url 'account_app:login_page' %}">ÿ®ÿ±ÿß€å ÿßŸÖÿ™€åÿßÿ≤ ŸÑÿ∑ŸÅÿß ŸÑÿß⁄Ø€åŸÜ ⁄©ŸÜ€åÿØ</a>
                                {% endif %}

                            </div>
                        </div>
                    </div>

                    <!-- clips -->
                    {% if clips %}
                        <div class="card card-item">
                            <div class="card-body">
                                <h5 class="font-weight-semi-bold pb-4">⁄©ŸÑ€åŸæ Ÿáÿß€å ÿ™Ÿá€åŸá ÿ¥ÿØŸá ÿßÿ≤ ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å</h5>
                                <div class="row">
                                    {% for clip in clips %}
                                        <div class="col-md-4 col-sm-12 mb-4">
                                            {% if clip.video %}
                                                <div class="embed-responsive embed-responsive-16by9">
                                                    <video class="embed-responsive-item" controls preload="metadata">
                                                        <source src="{{ clip.video.url }}" type="video/mp4">
                                                    </video>
                                                </div>
                                                <p class="mt-2 text-center">
                                                    {{ clip.title }} -
                                                    <a href="{{ clip.video.url }}" download>ÿØÿßŸÜŸÑŸàÿØ</a>
                                                </p>
                                            {% else %}
                                                <p>{{ clip.title }} - Ÿà€åÿØ€åŸà ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÜÿ¥ÿØŸá ÿßÿ≥ÿ™.</p>
                                            {% endif %}
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% endif %}


                    <!-- author -->
                    <div class="card card-item">
                        <div class="card-body">
                            <div class="course-overview-card pt-4">
                                <h4 class="font-weight-semi-bold pb-4">ÿØÿ± ŸÖŸàÿ±ÿØ ÿ≥ÿÆŸÜÿ±ÿßŸÜ</h4>
                                <div class="instructor-wrap">
                                    <div class="media media-card">
                                        <!-- avatar -->
                                        <div class="instructor-img">
                                            <a href="#" class="media-img d-block">
                                                {% if lecture.author.avatar %}
                                                    <img class="rounded-full lazy" src="{{ lecture.user.avatar.url }}" alt="ÿ™ÿµŸà€åÿ± ⁄©ÿßÿ±ÿ®ÿ±">
                                                {% else %}
                                                    <img class="rounded-full lazy" src="{% static 'images/small-avatar-1.jpg' %}" alt="⁄©ÿßÿ±ÿ®ÿ± ŸÖŸáŸÖÿßŸÜ">
                                                {% endif %}
                                            </a>
                                        </div>
                                        <!-- end instructor-img -->
                                        <div class="media-body">
                                            <h5><a href="teacher-detail.html">{{ lecture.author.get_full_name }}</a>
                                            </h5>
                                            <p class="p-3 text-justify">{{ lecture.author.about_user }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- rating -->
                    <div class="card card-item">
                        <div class="card-body">
                            <div class="course-overview-card pt-4">
                                <h3 class="fs-24 font-weight-semi-bold pb-40px">ÿ®ÿßÿ≤ÿÆŸàÿ±ÿØ ⁄©ÿßÿ±ÿ®ÿ±ÿßŸÜ</h3>
                                <div class="feedback-wrap">
                                    <div class="media media-card align-items-center">

                                        <!-- end review-rating-summary -->
                                        <div class="review-rating-summary">
                                            <span class="stats-average__count">{{ avg_rating }}</span>
                                            <div class="rating-wrap pt-1">
                                                <div class="review-stars">
                                                    {% for star in stars_display %}
                                                        {% if star == 'full' %}
                                                            <span class="la la-star"></span>
                                                        {% elif star == 'half' %}
                                                            <span class="la la-star-half-alt"></span>
                                                        {% else %}
                                                            <span class="la la-star-o"></span>
                                                        {% endif %}
                                                    {% endfor %}
                                                </div>
                                                <span class="rating-total d-block">({{ total_votes }}) </span>
                                                <span>ÿ±ÿ™ÿ®Ÿá ÿ®ŸÜÿØ€å ÿ≥ÿÆŸÜÿ±ÿßŸÜ€å</span>
                                            </div>
                                            <!-- end rating-wrap -->
                                        </div>

                                        <!-- review-bars -->
                                        <div class="media-body">
                                            {% for star in star_list %}
                                                <div class="review-bars d-flex align-items-center mb-2">
                                                    <div class="review-bars__text">{{ star }}&nbsp;ÿ≥ÿ™ÿßÿ±Ÿá</div>
                                                    <div class="review-bars__fill">
                                                        <div class="skillbar-box">
                                                            {% with percent=star_percentages|dict_get:star|default:0 %}
                                                                <div class="skillbar" data-percent="{{ percent }}%">
                                                                    <div class="skillbar-bar bg-3" style="width: {{ percent }}%;"></div>
                                                                </div>
                                                            {% endwith %}
                                                        </div>
                                                    </div>
                                                    <div class="review-bars__percent">{{ percent }}%</div>
                                                </div>
                                            {% endfor %}
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {% if messages %}
                        <div class="mb-3">
                            {% for message in messages %}
                                <div class="alert alert-{{ message.tags }}">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}

                    <!-- show comment -->
                    {% if comments %}
                        <div class="card card-item">
                            <div class="card-body">
                                <div class="comments-wrap pt-5" id="comments">
                                    <div class="d-flex align-items-center justify-content-between pb-4">
                                        <h3 class="fs-22 font-weight-semi-bold">ŸÜÿ∏ÿ±ÿßÿ™ <span
                                                class="ribbon ribbon-lg">{{ lecture_comments_count }}</span></h3>
                                    </div>
                                    <div class="section-block mb-4"></div>

                                    <div class="comment-list">
                                        {% for comment in comments %}
                                            {% if comment.is_active or request.user == comment.user %}
                                                <div class="media media-card border-bottom border-bottom-gray pb-4 mb-4 {% if not comment.is_active %}bg-light{% endif %}">
                                                    <div class="media-img mr-4 rounded-full">
                                                        {% if comment.user and comment.user.avatar %}
                                                            <img class="rounded-full lazy" src="{{ comment.user.avatar.url }}" alt="ÿ™ÿµŸà€åÿ± ⁄©ÿßÿ±ÿ®ÿ±">
                                                        {% else %}
                                                            <img class="rounded-full lazy" src="{% static 'images/small-avatar-1.jpg' %}" alt="⁄©ÿßÿ±ÿ®ÿ± ŸÖŸáŸÖÿßŸÜ">
                                                        {% endif %}
                                                    </div>

                                                    <div class="media-body">
                                                        <div class="d-flex flex-wrap align-items-center justify-content-between pb-1">
                                                            <h5 class="pb-2">
                                                                {% if comment.user %}
                                                                    {{ comment.user.get_full_name|default:comment.user.username }}
                                                                {% else %}
                                                                    {{ comment.name }}
                                                                {% endif %}
                                                            </h5>
                                                            <div class="review-stars">
                                                                {% if comment.user and comment.user.id in user_ratings %}
                                                                    {% with user_ratings|dict_get:comment.user.id as user_score %}
                                                                        {% for i in "12345" %}
                                                                            {% if forloop.counter <= user_score %}
                                                                                <span class="la la-star" style="color: gold;"></span>
                                                                            {% else %}
                                                                                <span class="la la-star-o" style="color: lightgray;"></span>
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                    {% endwith %}
                                                                {% else %}
                                                                    {# ⁄©ÿßÿ±ÿ®ÿ± ÿßŸÖÿ™€åÿßÿ≤ ŸÜÿØÿßÿØŸá #}
                                                                    {% for i in "12345" %}
                                                                        <span class="la la-star-o" style="color: lightgray;"></span>
                                                                    {% endfor %}
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <span class="d-block lh-18 pb-2">{{ comment.created_date|timeago }}</span>
                                                        <p class="pb-3">{{ comment.text }}</p>

                                                        {% if not comment.is_active and request.user == comment.user %}
                                                            <small class="text-warning">(ÿØÿ± ÿßŸÜÿ™ÿ∏ÿßÿ± ÿ™ÿ£€å€åÿØ ŸÖÿØ€åÿ±)</small>
                                                        {% endif %}
                                                    </div>
                                                </div>

                                                {# ŸÜŸÖÿß€åÿ¥ Ÿæÿßÿ≥ÿÆ‚ÄåŸáÿß #}
                                                {% for reply in comment.lecturecomment_set.all %}
                                                    {% if reply.is_active or request.user == reply.user %}
                                                        <div class="media media-card border-bottom border-bottom-gray pb-4 mb-4 review-reply">
                                                            <div class="media-img mr-4 rounded-full">
                                                                {% if reply.user and reply.user.avatar %}
                                                                    <img class="rounded-full lazy" src="{{ reply.user.avatar.url }}" alt="ÿ™ÿµŸà€åÿ± ⁄©ÿßÿ±ÿ®ÿ±">
                                                                {% else %}
                                                                    <img class="rounded-full lazy" src="{% static 'images/small-avatar-1.jpg' %}"
                                                                         alt="⁄©ÿßÿ±ÿ®ÿ± ŸÖŸáŸÖÿßŸÜ">
                                                                {% endif %}
                                                            </div>

                                                            <div class="media-body">
                                                                <h5 class="pb-2">
                                                                    {% if reply.user %}
                                                                        {{ reply.user.get_full_name|default:reply.user.username }}
                                                                    {% else %}
                                                                        {{ reply.name }}
                                                                    {% endif %}
                                                                </h5>

                                                                <span class="d-block lh-18 pb-2">{{ reply.created_date|timeago }}</span>
                                                                <p class="pb-3">{{ reply.text }}</p>
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}


                    <!-- add_comment -->
                    <div class="card card-item">
                        <div class="card-body">
                            <div id="comment-form"></div>
                            <div class="add-comment-wrap pt-5">
                                <h3 class="fs-22 font-weight-semi-bold pb-4">€å⁄© ŸÜÿ∏ÿ± ÿßÿ∂ÿßŸÅŸá ⁄©ŸÜ€åÿØ</h3>

                                <form method="post" class="row" action="">
                                    {% csrf_token %}

                                    <input type="hidden" name="parent_id" id="parent_id" value="">

                                    {% if request.user.is_authenticated %}
                                        <!-- message -->
                                        <div class="input-box col-lg-12">
                                            <div class="form-group">
                                                <textarea class="form-control form--control pl-3" name="message"
                                                          rows="10"></textarea>

                                            </div>
                                        </div>
                                    {% else %}
                                        <!-- name -->
                                        <div class="input-box col-lg-6">
                                            <label class="label-text">ŸÜÿßŸÖ</label>
                                            <div class="form-group">
                                                <input class="form-control form--control" type="text" name="name">
                                                <span class="la la-user input-icon"></span>
                                            </div>
                                        </div>

                                        <!-- email -->
                                        <div class="input-box col-lg-6">
                                            <label class="label-text">Ÿæÿ≥ÿ™ ÿßŸÑ⁄©ÿ™ÿ±ŸàŸÜ€å⁄©</label>
                                            <div class="form-group">
                                                <input class="form-control form--control" type="email" name="email">
                                                <span class="la la-envelope input-icon"></span>
                                            </div>
                                        </div>

                                        <!-- message -->
                                        <div class="input-box col-lg-12">
                                            <div class="form-group">
                                                <textarea class="form-control form--control pl-3" name="message"
                                                          rows="10"></textarea>

                                            </div>
                                        </div>
                                    {% endif %}

                                    <!-- captcha -->
                                    <div class="input-box">
                                        <label class="label-text">ÿπÿ®ÿßÿ±ÿ™ ÿßŸÖŸÜ€åÿ™€å</label>
                                        <div class="form-group">
                                            <img src="{{ captcha_url }}" alt="captcha" class="captcha">
                                            <input type="hidden" name="captcha_0" value="{{ captcha_key }}" required="" id="id_captcha_0"
                                                   autocomplete="off">
                                            <input type="text" name="captcha_1" required="" id="id_captcha_1" autocapitalize="off"
                                                   autocomplete="off" autocorrect="off" spellcheck="false">
                                            <a href="#" id="refresh-captcha">‚Üª ÿ™ÿ∫€å€åÿ± ÿ™ÿµŸà€åÿ±</a>


                                        </div>
                                    </div>

                                    <!-- submit -->
                                    <div class="btn-box col-lg-12">
                                        <button class="btn theme-btn" type="submit">ÿ´ÿ®ÿ™ ⁄©ÿ±ÿØŸÜ ŸÜÿ∏ÿ±</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-lg-4">
                    <div class="sidebar">

                        {% render_partial 'media_app.views.SearchLectureView' %}
                        {% render_partial 'media_app.views.CategoryLecturesView' %}
                        {% render_partial 'media_app.views.ArchiveLecturesView' %}
                        {% render_partial 'media_app.views.RecentLecturesView' %}

                        <!-- tag lecture -->
                        <div class="card card-item">
                            <div class="card-body">
                                <h3 class="card-title fs-18 pb-2">ÿ®ÿ±⁄Üÿ≥ÿ® Ÿáÿß€å ÿØŸàÿ±Ÿá</h3>
                                <div class="divider"><span></span></div>
                                <ul class="generic-list-item generic-list-item-boxed d-flex flex-wrap fs-15">
                                    {% for tag in lecture.selected_tags.all %}
                                        <li class="mr-2"><a href="{% url 'media_app:lecture_list_page' %}?tag={{ tag.id }}">{{ tag.title }}</a></li>
                                    {% endfor %}

                                </ul>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}