{% extends 'shared/dashboard.html' %}
{% load shamsi_tags %}

{% block title %}پروفایل - ایجاد دسته بندی{% endblock %}

{% block content %}

    <div class="dashboard-content-wrap">
        <div class="dashboard-menu-toggler btn theme-btn theme-btn-sm lh-28 theme-btn-transparent mb-4 ml-3"><i
                class="la la-bars mr-1"></i> منو
        </div>

        <!-- main content -->
        <div class="container-fluid">

            <!-- breadcrumb -->
            <div class="breadcrumb-content d-flex flex-wrap align-items-center justify-content-between mb-5">
                <div class="media media-card align-items-center">
                    <div class="media-img media--img media-img-md rounded-full">
                        <img class="rounded-full" src="{{ request.user.avatar.url }}" alt="تصویر کوچک دانش آموز">
                    </div>
                    <div class="media-body">
                        <h2 class="section__title fs-30">{{ request.user.get_full_name }}</h2>
                        <div class="rating-wrap d-flex align-items-center pt-2">
                            <div class="review-stars">
                                <span class="rating-number">4.4</span>
                                <span class="la la-star"></span>
                                <span class="la la-star"></span>
                                <span class="la la-star"></span>
                                <span class="la la-star"></span>
                                <span class="la la-star-o"></span>
                            </div>
                            <span class="rating-total pl-1">(20230)</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="section-block mb-5"></div>
            <div class="dashboard-heading mb-5">
                <h3 class="fs-22 font-weight-semi-bold">دسته بندی جدید</h3>
            </div>
            <form action=""
                  method="post"
                  class="MultiFile-intercepted"
                  enctype="multipart/form-data">
                {% csrf_token %}

                <div class="card card-item">
                    <div class="card-body">
                        <div class="row">

                            <!-- title -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">عنوان دسته بندی</label>
                                    <input class="form-control form--control pl-3" type="text" name="title"
                                           value="{{ object.title }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- parent -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">والد</label>
                                    <select name="parent" class="form-control form--control pl-3"
                                            {% if read_only %}disabled{% endif %}>
                                        <option value="">ندارد</option>
                                        {% for cat in all_categories %}
                                            {% if cat != object %} {# جلوگیری از انتخاب خودش به عنوان والد #}
                                                <option value="{{ cat.id }}"
                                                        {% if object.parent == cat %}selected{% endif %}>
                                                    {{ cat.title }}
                                                </option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <!-- url_title -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">url_title</label>
                                    <input class="form-control form--control pl-3" type="text" name="url_title"
                                           value="{{ object.url_title }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- is_active -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">فعال؟</label>
                                    <input class="form-control form--control pl-3" type="text" name="is_active"
                                           value="{{ object.is_active }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- is_delete -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">حذف شده؟</label>
                                    <input class="form-control form--control pl-3" type="text" name="is_delete"
                                           value="{{ object.is_delete }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- image -->
                            <div class="col-lg-12">
                                <div class="form-group mb-0">
                                    <label class="label-text">تصویر دسته بندی</label>
                                    <div class="input-box col-lg-12 mb-5">
                                        <div class="media media-card align-items-center">
                                            <div class="media-img media-img-lg mr-4 bg-gray">
                                                {% if object.image %}
                                                    <img class="mr-3" src="{{ object.image.url }}"
                                                         alt="تصویر دسته بندی">
                                                {% else %}
                                                    <img class="mr-3" src="/static/images/team11.jpg"
                                                         alt="تصویر آواتار">
                                                {% endif %}
                                            </div>
                                            {% if not read_only %}
                                                <div class="media-body">
                                                    <div class="file-upload-wrap file-upload-wrap-2">
                                                        <div class="MultiFile-wrap" id="MultiFile2">
                                                            <input type="file"
                                                                   name="image"
                                                                   class="multi file-upload-input with-preview MultiFile-applied"
                                                                   multiple=""
                                                                   id="MultiFile2"
                                                                   value="">
                                                            <div class="MultiFile-list" id="MultiFile2_list"></div>
                                                        </div>
                                                        <span class="file-upload-text"><i class="la la-photo mr-2"></i>یک عکس آپلود کنید</span>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                {% if not read_only %}
                    <div class="course-submit-btn-box pb-4">
                        <button class="btn theme-btn" type="submit">ذخیره دسته بندی</button>
                    </div>
                {% endif %}
            </form>
        </div>
    </div>


{% endblock %}