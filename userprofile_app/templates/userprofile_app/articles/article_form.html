{% extends 'shared/dashboard.html' %}
{% load shamsi_tags %}

{% block title %}پروفایل - ایجاد مقاله{% endblock %}

{% block content %}

    <div class="dashboard-content-wrap">
        <div class="dashboard-menu-toggler btn theme-btn theme-btn-sm lh-28 theme-btn-transparent mb-4 ml-3"><i
                class="la la-bars mr-1"></i> منو
        </div>

        <!-- main content -->
        <div class="container-fluid">

            <!-- breadcrumb -->
            <div class="breadcrumb-content d-flex flex-wrap align-items-center justify-content-between mb-5">
                <div class="media media-card align-items-center">
                    <div class="media-img media--img media-img-md rounded-full">
                        <img class="rounded-full" src="{{ request.user.avatar.url }}" alt="تصویر کوچک دانش آموز">
                    </div>
                    <div class="media-body">
                        <h2 class="section__title fs-30">{{ request.user.get_full_name }}</h2>
                        <div class="rating-wrap d-flex align-items-center pt-2">
                            <div class="review-stars">
                                <span class="rating-number">4.4</span>
                                <span class="la la-star"></span>
                                <span class="la la-star"></span>
                                <span class="la la-star"></span>
                                <span class="la la-star"></span>
                                <span class="la la-star-o"></span>
                            </div>
                            <span class="rating-total pl-1">(20230)</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="section-block mb-5"></div>
            <div class="dashboard-heading mb-5">
                <h3 class="fs-22 font-weight-semi-bold">مقاله جدید</h3>
            </div>

            <form action=""
                  method="post"
                  class="MultiFile-intercepted"
                  enctype="multipart/form-data">
                {% csrf_token %}

                <div class="card card-item">
                    <div class="card-body">
                        <div class="row">

                            <!-- title -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">عنوان مقاله</label>
                                    <input class="form-control form--control pl-3" type="text" name="title"
                                           value="{{ form.instance.title|default:'' }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- slug -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">اسلاگ</label>
                                    <input class="form-control form--control pl-3" type="text" name="slug"
                                           value="{{ form.instance.slug|default:'' }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- selected_categories -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">دسته بندی مقاله</label>
                                    <select name="selected_categories" multiple class="form-control"
                                            {% if read_only %}disabled{% endif %}>
                                        {% for category in categories %}
                                            <option value="{{ category.id }}"
                                                    {% if category in form.instance.selected_categories.all %}
                                                    selected
                                                    {% endif %}>
                                                {{ category.title }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <!-- selected_tags -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">تگ های مقاله</label>
                                    <select name="selected_tags" multiple class="form-control"
                                            {% if read_only %}disabled{% endif %}>
                                        {% for tag in tags %}
                                            <option value="{{ tag.id }}"
                                                    {% if tag in form.instance.selected_tags.all %}
                                                    selected
                                                    {% endif %}>
                                                {{ tag.title }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>


                            <!-- status -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">وضعیت</label>
                                    <input class="form-control form--control pl-3" type="text" name="status"
                                           value="{{ form.instance.status|default:'' }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- is_active -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">فعال</label>
                                    <input class="form-control form--control pl-3" type="text" name="is_active"
                                           value="{{ form.instance.is_active|yesno:'بله,خیر' }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- is_delete -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">حذف شده</label>
                                    <input class="form-control form--control pl-3" type="text" name="is_delete"
                                           value="{{ form.instance.is_delete|yesno:'بله,خیر' }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- author -->
                            <div class="col-lg-6">
                                <div class="form-group">
                                    <label class="label-text">نویسنده</label>
                                    <input class="form-control form--control pl-3" type="text" name="author"
                                           value="{{ form.instance.author.get_full_name|default:'' }}"
                                           {% if read_only %}disabled{% endif %}>
                                </div>
                            </div>

                            <!-- short_description -->
                            <div class="input-box col-lg-12">
                                <label class="label-text">شرح کوتاه از مقاله</label>
                                <div class="form-group">
                        <textarea rows="4" class="form-control form--control user-text-editor pl-3"
                                  name="short_description"
                                  {% if read_only %}disabled{% endif %}>{{ form.instance.short_description|default:'' }}</textarea>
                                </div>
                            </div>

                            <!-- text -->
                            <div class="input-box col-lg-12">
                                <label class="label-text">متن مقاله</label>
                                <div class="form-group">
                        <textarea rows="15" class="form-control form--control user-text-editor pl-3"
                                  name="text"
                                  {% if read_only %}disabled{% endif %}>{{ form.instance.text|default:'' }}</textarea>
                                </div>
                            </div>

                            <!-- image -->
                            <div class="col-lg-12">
                                <div class="form-group mb-0">
                                    <label class="label-text">تصویر مقاله</label>
                                    <div class="input-box col-lg-12 mb-5">
                                        <div class="media media-card align-items-center">
                                            <div class="media-img media-img-lg mr-4 bg-gray">
                                                {% if form.instance.image %}
                                                    <img class="mr-3" src="{{ form.instance.image.url }}"
                                                         alt="تصویر مقاله">
                                                {% else %}
                                                    <img class="mr-3" src="/static/images/team11.jpg"
                                                         alt="تصویر پیش‌فرض">
                                                {% endif %}
                                            </div>
                                            {% if not read_only %}
                                                <div class="media-body">
                                                    <div class="file-upload-wrap file-upload-wrap-2">
                                                        <div class="MultiFile-wrap" id="MultiFile2">
                                                            <input type="file"
                                                                   name="image"
                                                                   class="multi file-upload-input with-preview MultiFile-applied"
                                                                   id="MultiFile2">
                                                            <div class="MultiFile-list" id="MultiFile2_list"></div>
                                                        </div>
                                                        <span class="file-upload-text"><i class="la la-photo mr-2"></i>یک عکس آپلود کنید</span>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                {% if not read_only %}
                    <div class="course-submit-btn-box pb-4">
                        <button class="btn theme-btn" type="submit">ذخیره مقاله</button>
                    </div>
                {% endif %}
            </form>

        </div>
    </div>


{% endblock %}